# План автоматизации тестирования сервиса, взаимодействующего с СУБД и API Банка

## Перечень автоматизируемых сценариев
   **Тестовые данные:**
   * Сервис обрабатывает только две предоставленные карты для тестирования:
   * Карта №1 - 4444 4444 4444 4441 состояние APPROVED
   * Карта №2 - 4444 4444 4444 4442 состояние DECLINED
   * Номер карты: 16 цифр
   * Месяц: число от 01 до 12 (при совпадение поля "Год" с текущим годом, номер месяца не должен быть раньше текущего)
   * Год: 2 последние цифры текущего и последующих лет
   * Владелец: латиница в ВЕРХНЕМ РЕГИСТРЕ, дефис и пробел, первый и последний символ должны быть буквами
   * CVC/CVV: число длиной 3 цифры

### Тестирование API 
   ***Дебет:***
1. Отправка POST запроса платежа с валидно заполненными данными и Карта №1 на http://localhost:9999   
      Ожидаемый результат: статус 200, появление соответствующей записи в БД
2. Отправка POST запроса платежа с валидно заполненными данными и Карта №2 на http://localhost:9999   
      Ожидаемый результат: статус 200, появление соответствующей записи в БД
3. Отправка POST запроса с пустой формой заполнения на http://localhost:9999   
      Ожидаемый результат: статус 400, в БД не появляются новые записи
4. Отправка POST запроса платежа с пустым значением номер карты (остальные данные заполнены валидно) на http://localhost:9999
      Ожидаемый результат: статус 400, в БД не появляются новые записи
5. Отправка POST запроса платежа с пустым значением "month" (остальные данные заполнены валидно) на http://localhost:9999
      Ожидаемый результат: статус 400, в БД не появляются новые записи
6. Отправка POST запроса платежа с пустым значением "year" (остальные данные заполнены валидно) на http://localhost:9999
      Ожидаемый результат: статус 400, в БД не появляются новые записи
7. Отправка POST запроса платежа с пустым значением владельца карты (остальные данные заполнены валидно) на http://localhost:9999
      Ожидаемый результат: статус 400, в БД не появляются новые записи
8. Отправка POST запроса платежа с пустым значением "cvc" (остальные данные заполнены валидно) на http://localhost:9999
      Ожидаемый результат: статус 400, в БД не появляются новые записи
     
  ***Кредит:***
     
9. Отправка POST запроса платежа с валидно заполненымми даными и карта №1 на http://localhost:9999   
     Ожидаемый результат: статус 200, появление соответствующей записи в БД
10. Отправка POST запроса платежа с валидно заполненными данными и карта №2 на http://localhost:9999   
     Ожидаемый результат: статус 200, появление соответствующей записи в БД
11. Отправка POST запроса платежа с пустой формой заполнения на http://localhost:9999   
     Ожидаемый результат: статус 400, в БД не появляются новые записи
12. Отправка POST запроса платежа с пустым значением номер карты (остальные данные заполнены валидно) на http://localhost:9999
     Ожидаемый результат: статус 400, в БД не появляются новые записи
13. Отправка POST запроса платежа с пустым значением "month" (остальные данные заполнены валидно) на http://localhost:9999
     Ожидаемый результат: статус 400, в БД не появляются новые записи
14. Отправка POST запроса платежа с пустым значением "year" (остальные данные заполнены валидно) на http://localhost:9999
     Ожидаемый результат: статус 400, в БД не появляются новые записи
15. Отправка POST запроса платежа с пустым значением владельца карты (остальные данные заполнены валидно) на http://localhost:9999
     Ожидаемый результат: статус 400, в БД не появляются новые записи
16. Отправка POST запроса платежа с пустым значением "cvc" (остальные данные заполнены валидно) на http://localhost:9999
     Ожидаемый результат: статус 400, в БД не появляются новые записи

### Тестирование UI

1. Успешная оплата тура "Путешествие дня" при валидном заполнении полей формы "Оплата по карте" по действующей карте (номер карты заполнен с пробелами после каждых 4 символов)  
       Ожидаемый результат: появление сообщения об успешной оплате тура
2. Отказ в оплате тура "Путешествие дня" при валидном заполнении полей формы "Оплата по карте" по declined карте (номер карты заполнен с пробелами после каждых 4 символов)  
       Ожидаемый результат: появление сообщения об отказе в оплате тура
3. Успешная оплата в кредит тура "Путешествие дня" при валидном заполнении полей формы "Кредит по данным карты" по действующей карте (номер карты заполнен с пробелами после каждых 4 символов)  
       Ожидаемый результат: появление сообщения об успешной взятие кредита
4. Отказ в кредите на покупку тура "Путешествие дня" при валидном заполнении полей формы "Кредит по данным карты" по declined карте (номер карты заполнен с пробелами после каждых 4 символов)  
       Ожидаемый результат: появление сообщения об отказе в взятие кредита
5. Заполнение всех полей валидными данными формы "Оплата по карте" тура "Путешествие дня" с последующим переключением на форму "Кредит по данным карты"    
       Ожидаемый результат: форма переключиться, поля останутся заполненными теми же данными
6. Заполнение всех полей валидными данными формы "Кредит по данным карты" тура "Путешествие дня" с последующим переключением на форму "Оплата по карте"  
       Ожидаемый результат: форма переключиться, поля останутся заполненными теми же данными
7. Оставление всех полей пустыми   
       Ожидаемый результат: под всеми полями появиться предупреждение о пустом поле, невозможно отправить форму

***Заполнение поля "Номер карты"***

1. Заполнение поля "Номер карты" номером действующей карты без пробелов, остальные поля заполнены валидно* в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: появление сообщения об успешной оплате тура
2. Заполнение поля "Номер карты" 1 рандомной цифрой, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: под полем "Номер карты" появиться предупреждение о недопустимой длине поля
3. Заполнение поля "Номер карты" 11 рандомными цифрами, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: появление сообщения об отказе в оплате тура
4. Заполнение поля "Номер карты" 13 рандомными цифрами, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: появление сообщения об отказе в оплате тура
5. Заполнение поля "Номер карты" 12  нулями, остальные поля заполнены валидно* в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем "Номер карты" появиться сообщения о появление сообщения об отказе в оплате тура
6. Заполнение поля "Номер карты" 12 рандомными спецсимволами, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем "Номер карты" появиться предупреждение об недопустимых символах
7. Заполнение поля "Номер карты" 12 рандомными буквами латиницы, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем "Номер карты" появиться предупреждение об недопустимых символах
8. Заполнение поля "Номер карты" 12 рандомными буквами кириллицы, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем "Номер карты" появиться предупреждение об недопустимых символах

***Заполнение поля "День"***

1. Заполнение поля "День" 3 цифрами, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: обрезание последней цифры в поле "День", появление сообщения об успешной оплате тура
2. Заполнение поля "День" значением 00, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем "День" появиться предупреждение об невалидном значение
3. Заполнение поля "День" значением 1 (в зависимости ), остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: автодополнение нулем вначале в поле "День",появление сообщения об успешной оплате тура
4. Заполнение поля "День" значением 12, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: появление сообщения об успешной оплате тура
5. Заполнение поля "День" значением 32, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем "День" появиться предупреждение о невалидном значении
6. Заполнение поля "День" двумя рандомными спецсимволами, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем "День" появиться предупреждение о невалидном значении
7. Заполнение поля "День" буквами латиницы, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем "День" появиться предупреждение о недопустимых символах
8. Заполнение поля "День" буквами кирилицы, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем "День" появиться предупреждение о недопустимых символах


***Заполнение поля "Месяц"***

1. Заполнение поля "Месяц" 3 цифрами, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: обрезание последней цифры в поле "Месяц", появление сообщения об успешной оплате тура
2. Заполнение поля "Месяц" значением 00, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем "Месяц" появиться предупреждение об невалидном значение
3. Заполнение поля "Месяц" значением 1, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: автодополнение нулем вначале в поле "Месяц",появление сообщения об успешной оплате тура
4. Заполнение поля "Месяц" значением 12, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: появление сообщения об успешной оплате тура
5. Заполнение поля "Месяц" значением 13, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем "Месяц" появиться предупреждение о невалидном значении
6. Заполнение поля "Месяц" двумя рандомными спецсимволами, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем "Месяц" появиться предупреждение о невалидном значении
7. Заполнение поля " Месяц " буквами латиницы, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем " Месяц " появиться предупреждение о недопустимых символах
8. Заполнение поля " Месяц " буквами кирилицы, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем " Месяц " появиться предупреждение о недопустимых символах

***Заполнение поля "Год"***

1. Оставление поля "Год" пустым, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем "Год" появиться предупреждение о пустом поле
2. Заполнение поля " Год " предыдущим годом, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: под полем "Год" появиться предупреждение об невалидном значении
3. Заполнение поля " Год " текущим годом, а поля "Месяц" предыдущим месяцем, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: под полем "Месяц" появиться предупреждение об невалидном значение
4. Заполнение поля " Год " текущим годом и поля "Месяц" текущим месяцем, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: появление сообщения об успешной оплате тура
5. Заполнение поля " Год " 1 цифрой, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: под полем "Год" появиться предупреждение об невалидном значение
6. Заполнение поля " Год " 3 цифры, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: значение обрезается до 2 цифр
7. Заполнение поля " Год " плюс 6 лет к текущему году, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
   Ожидаемый результат: под полем "Год" появиться предупреждение о невалидном значение, срок действия карты истек
8. Заполнение поля "Год" рандомными спецсимволами, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: под полем "Год" появиться предупреждение о недопустимых символах
9. Заполнение поля " Год " буквами латиницы, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: под полем " Год " появиться предупреждение о недопустимых символах
10. Заполнение поля " Год " буквами кирилиицы, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем " Год " появиться предупреждение о недопустимых символах

***Заполнение поля " Владелец "***

1. Заполнение поля " Владелец " валидными данными с дефисом, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: появление сообщения об успешной оплате тура
2. Заполнение поля " Владелец " в нижнем регистре, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: автоисправление поля "Владелец" на верхний регистр
3. Заполнение поля " Владелец " с пробелами в начале и в конце, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: автоудаление лишних пробелов в поле "Владелец"
4. Заполнение поля " Владелец " с дефисами в начале и в конце, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: автоудаление лишних символов в поле "Владелец"
5. Заполнение поля " Владелец " цифрами, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: под полем "Владелец" появиться предупреждение о невалидном значении
6. Заполнение поля " Владелец " максимальным количеством букв на латинице в одно слово, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: появление сообщения об успешной оплате тура
7. Заполнение поля " Владелец " максимальным количеством букв +1 на латинице в одно слово, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: появление сообщения об успешной оплате тура
8. Заполнение поля " Владелец " -1 максимального количества букв  на латинице в одно слово, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: появление сообщения об успешной оплате тура
9. Заполнение поля " Владелец " одной буквой на латинице, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: появиться предупреждение о невалидном значении, должно быть минимум 2 буквы
10. Заполнение поля " Владелец " кириллицей, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: под полем "Владелец" появиться предупреждение о невалидном значении
11. Заполнение поля " Владелец " рандомными спецсимволами, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: под полем "Владелец" появиться предупреждение о невалидном значении

***Заполнение поля "CVC/CVV***

1. Заполнение поля "CVC/CVV" 1 рандомной цифрой, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
       Ожидаемый результат: под полем "CVC/CVV" появление сообщения о недопустимой длине
2. Заполнение поля "CVC/CVV" 4 рандомными цифрами, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: 4 цифра в поле "CVC/CVV" обрезается
3. Заполнение поля "CVC/CVV" 3 рандомными буквами латиницы, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: под полем "CVC/CVV" появление сообщения о невалидном значение
4. Заполнение поля "CVC/CVV" 3 рандомными буквами кириллицы, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: под полем "CVC/CVV" появление сообщения о невалидном значение
5. Заполнение поля "CVC/CVV" 3 рандомными спецсимволами, остальные поля заполнены валидно в форме "Оплата по карте" тура "Путешествие дня"  
      Ожидаемый результат: под полем "CVC/CVV" появление сообщения о невалидном значение

## 2. Перечень используемых инструментов с обоснованием выбора.

1. IDE: IntelliJ IDEA удобная популярная среда Java-разработки с боьшим набором инструментов и плагинов, в т.ч. для подготовки автотестов;
2. Java JDK 11 или выше – мощный объектно-ориентированный язык программирования с обширным набором библиотек, общепринятое базовое средство автоматизации тестирования;
3. Система сборки: Gradle (легче настраивать зависимости)
4. Тестовая среда: JUnit Jupiter, инструмент тестирования, наиболее популярная библиотека для проведения тестирования в Java;
5. Фреймворк для UI тестирования: Selenide, очень удобен при тестировании веб-интерфейса;
6. Фреймворк для API тестирования: REST Assured для тестирования отправки email вместе с JSON Schema Validator (для отправки необходимых запросов и валидации JSON схемы)
7. Система репортинга: Allure (более сложные системы репортинга будут излишни)
8. Фреймворки для управления данными:

* Java Faker (для генерации данных)
* Gson (для генерации body запросов при API тестирования)
* Git – система контроля версий разрабатываемого ПО, взаимодействует с Github;
* Github – облачная среда для хранения версий проекта с тестами и для ведения разработки ПО;
* Docker и Docker Compose для запуска контейнера с базой данных
* Database Navigator, Клиент для работы с БД
* DBeaver CE, клиент для работы с БД

## 3. Перечень и описание возможных рисков при автоматизации:

1. Критические баги приложения
2. Проблемы с запуском и подключением БД;
3. Появление "мусорных" записей в БД
4. Уничтожение данных в БД при некорректной реализации удаления данных.
5. После каждого прогона тестов необходимо очистить БД от записей
6. Из-за требований совместимости с двумя БД: MySQL, PostgreSQL, могут возникникнуть проблемы с разностью диалектов SQL
7. Из-за требований совместимости с двумя БД: MySQL, PostgreSQL, создается дополнительная трудность с настройкой SUT
8. Понижение производительности из-за недостаточной мощности и памяти ПК;
9. Интеграция данных из тестируемых сценариев в тесты;
10. Несоответствие тестовых данных Faker, данным из тестируемых сценариев;
11. Поиск и применение нужных библиотек и зависимостей.
12. Зависимость авто-тестов от текущей реализации веб-элементов, даже не значительное их изменение может привести к падению авто-тестов;
13. Авто-тесты не проверяют графическую составляющую, а именно едет ли верстка при тех или иных действиях, комфортна ли выбранная цветовая схема оформления и тд.
14. Добавление новых блоков на главную страницу сайта: появляются новые пользовательские сценарии, не охваченные тестами
15. Удаление / добавление полей в форму: тесты падают / уменьшается охват тестирования отправки формы
16. Трудности с поиском локаторов тестируемых элементов на странице
17. Из-за того что тестируется функционал "Путешествие дня", данные для тестов не должны быть "захардкоденными" т.е. тесты должны проходить после каждодневных изменений (например, изменение цены тура)
18. Заполнение полей "День", "Месяц" и "Год" должно быть не "захардкоренными" и изменяться с течением времени
19. Поскольку в качестве банковского сервиса выступает заглушка, есть риск что при подключение реальной системы появятся новые не выявленные дефекты


## 4. Интервальная оценка с учётом рисков (в часах)

1. Изучение предоставленного технического задания - 3 часа;
2. Разработка и написание плана автоматизации тестирования - 15 часов;
3. Подключение СУБД, библиотек, зависимостей, запуск и изучение приложения - 15 часов;
4. Разработка helpers и PageObjects - 20 часов;
5. Написания кода авто-тестов - 96 часов;
6. Подготовка отчетов о проделанной работе, в случае обнаружения багов, составление issues - 32 часов;
7. Общее затраченное время - 181 часов.
8. В запас - дополнительно 72 часа.

## 5. План сдачи работ

1. Написание плана автоматизации тестирования - дата сдачи 05.06.23г;
2. Написание кода автотестов - примерная дата сдачи 12.06.2023г;
3. Составление issues, подготовка отчетов о проделанной работе - примерная дата сдачи 15.06.2023г.
